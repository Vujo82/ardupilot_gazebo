<?xml version="1.0"?>

<launch>
	<arg name="name" default="bebop"/>
	<arg name="velodyne_name" default="velodyne_model"/>
	<arg name="tf_prefix" default="$(arg name)"/>
	<arg name="x" default="0.0"/>
	<arg name="y" default="0.0"/>
	<arg name="z" default="0.031"/>
	<arg name="wind_force" default="0.0"/>
	<arg name="wind_start" default="0.0"/>
	<arg name="wind_duration" default="0.0"/>
	<arg name="wind_direction_x" default="0.0"/>
	<arg name="wind_direction_y" default="0.0"/>
	<arg name="wind_direction_z" default="0.0"/>
	<arg name="enable_ground_truth" default="true"/>
	<arg name="enable_velodyne" default="true" />
	<arg name="model" value="$(find ardupilot_gazebo)/models/bebop/urdf/bebop.urdf.xacro" />
  <arg name="brick_green" value="$(find ardupilot_gazebo)/models/bebop/urdf/brick_green.urdf"/>
  <arg name="brick_red" value="$(find ardupilot_gazebo)/models/bebop/urdf/brick_red.urdf"/>
  <arg name="building" value="$(find potential_fields)/urdf/building.urdf.xacro"/>

    <include file="$(find potential_fields)/launch/empty_world.launch">
	 	<arg name="world_name" value="$(find potential_fields)/worlds/test_exploration.world"/>
        <arg name="paused" value="false" />
        <arg name="use_sim_time" value="true"/>
        <arg name="verbose" value="true" />
    </include>

	<include file="$(find potential_fields)/launch/building.launch">		
		<arg name="x" value="20"/>
		<arg name="y" value="2"/>
    </include>
	<!-- send the robot XML to param server -->
	<param name="robot_description" command="
	  $(find xacro)/xacro --inorder $(arg model)
	  enable_ground_truth:=$(arg enable_ground_truth)
	  namespace:=$(arg name)
	  wind_force:=$(arg wind_force)
	  wind_start:=$(arg wind_start)
	  wind_duration:=$(arg wind_duration)
	  wind_direction_x:=$(arg wind_direction_x)
	  wind_direction_y:=$(arg wind_direction_y)
	  wind_direction_z:=$(arg wind_direction_z)
	  enable_velodyne:=$(arg enable_velodyne)
	  "
	/>

	<param name="tf_prefix" type="string" value="$(arg tf_prefix)" />
	
	<!-- push robot_description to factory and spawn robot in gazebo -->
	<node name="spawn_robot" pkg="gazebo_ros" type="spawn_model"
	 args="-param robot_description
	       -urdf
	       -x $(arg x)
	       -y $(arg y)
	       -z $(arg z)
	       -model $(arg name)"
	 respawn="false" output="screen" >
	</node>

  <!--node name="spawn_brick" pkg="gazebo_ros" type="spawn_model"
        args="-file $(arg brick_red) -urdf -x 50 -y 0 -z 0.2 -model brick_red"
        respawn="false" output="screen"
  />
	
	<node name="camera_transform" pkg="tf" 
		type="static_transform_publisher" 
		args="0.111 0 0.0217 0 1.57 0 $(arg name)/base_link $(arg name)/camera 100" /-->
		
	<group if="$(arg enable_velodyne)">
    
        <!-- Transform publisher and rviz for velodyne -->
        <!-- <node 
            name="velodyne_transform" pkg="tf" 
            type="static_transform_publisher" 
            args="0.1 0 0.15 0. 0.1323284641020683 3.141592653589793 $(arg name)/base_link $(arg name)/leddar 100" >
		</node>

		 <node 
            name="imu_transform" pkg="tf" 
            type="static_transform_publisher" 
            args="0. 0 0. 0. 0. 0. $(arg name)/base_link imu_link 100" >
		</node> -->
    </group>
    
</launch>
